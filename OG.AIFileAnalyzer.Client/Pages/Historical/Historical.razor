@page "/Historical"
@using OG.AIFileAnalyzer.Client.Services.Historical
@using OG.AIFileAnalyzer.Common.Entities

<RadzenButton Icon="assignment_returned"
              ButtonStyle="ButtonStyle.Success"
              Variant="Variant.Filled"
              Size="ButtonSize.Small"
              Click="@((args) => ExportToExcel())"
              Text="Export to Excel"
              Style="margin-bottom: 1rem"/>

<RadzenDataGrid @ref="logsGrid"
                AllowPaging="true"
                AllowSorting="true"
                IsLoading="@isLoading"
                Data="@(logs)"
                TItem="LogEntity"
                Count="@count"
                LoadData="@LoadData"
                PageSize="10"
                PagerHorizontalAlign="HorizontalAlign.Center">
    <Columns>
        <RadzenDataGridColumn TItem="LogEntity" Property="Id" Title="Id" />
        <RadzenDataGridColumn TItem="LogEntity" Property="ActionType" Title="Action" />
        <RadzenDataGridColumn TItem="LogEntity" Property="Date" Title="Date" />
        <RadzenDataGridColumn TItem="LogEntity" Property="Description" Title="Description" />
        <RadzenDataGridColumn TItem="LogEntity" Title="Details" TextAlign="TextAlign.Center">
            <Template Context="log">
                @if (log.ActionType == Common.Consts.ActionType.IA)
                {
                    <RadzenButton Icon="info" ButtonStyle="ButtonStyle.Info" Variant="Variant.Filled" Size="ButtonSize.Small" Click="@((args) => ShowAnalysisResult(log))" />
                }
            </Template>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>